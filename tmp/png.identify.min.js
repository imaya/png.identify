/** @license png.identify.js 2012 - imaya [ https://github.com/imaya/png.identify.js ] The MIT License */
(function() {'use strict';function m(a){throw a;}var o=void 0,aa=this;function q(a,f){var b=a.split("."),c=aa;!(b[0]in c)&&c.execScript&&c.execScript("var "+b[0]);for(var d;b.length&&(d=b.shift());)!b.length&&f!==o?c[d]=f:c=c[d]?c[d]:c[d]={}};var r="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array;function s(a){var f=a.length,b=0,c=Number.POSITIVE_INFINITY,d,e,h,g,i,j,k,p,l,n;for(l=0;l<f;++l)a[l]>b&&(b=a[l]),a[l]<c&&(c=a[l]);d=1<<b;e=new (r?Uint32Array:Array)(d);h=[];g=1;i=0;for(j=2;g<=b;){for(l=0;l<f;++l)if(a[l]===g){k=0;p=i;for(n=0;n<g;++n)k=k<<1|p&1,p>>=1;h.push([l,k,g]);for(n=k;n<d;n+=j)e[n]=g<<16|l;++i}++g;i<<=1;j<<=1}return[e,b,c,h]};function t(a,f){this.f=[];this.j=32768;this.e=this.i=this.b=0;this.input=r?new Uint8Array(a):a;this.d=this.u=this.g=0;this.N=this.s=!1;if(f&&(f.index&&(this.b=f.index),f.blockSize))this.j=f.blockSize;this.c=new (r?Uint8Array:Array)(this.j)}
t.prototype.l=function(){var a,f=this.f,b=this.u;r||(this.c.subarray=this.c.slice);for(;!this.s;){f[this.d]={};a=this.b;var c=u(this,3);c&1&&(this.s=!0);this.f[this.d]["final"]=c&1;c>>>=1;this.f[this.d].type=c;switch(c){case 0:var c=this.input,d=this.b,e=this.c,h=this.g,g=o,i=o,j=o;this.e=this.i=0;g=c[d++];g===o&&m(Error("invalid uncompressed block header: LEN (first byte)"));i=g;g=c[d++];g===o&&m(Error("invalid uncompressed block header: LEN (second byte)"));i|=g<<8;g=c[d++];g===o&&m(Error("invalid uncompressed block header: NLEN (first byte)"));
j=g;g=c[d++];g===o&&m(Error("invalid uncompressed block header: NLEN (second byte)"));j|=g<<8;i===~j&&m(Error("invalid uncompressed block header: length verify"));for(d+i>c.length&&m(Error("input buffer is broken"));h+i>e.length;)e=v(this,{z:2});if(r)e.set(c.subarray(d,d+i),h),h+=i,d+=i;else for(;i--;)e[h++]=c[d++];this.b=d;this.g=h;this.c=e;break;case 1:w(this,ba,ca);break;case 2:da(this);break;default:m(Error("unknown BTYPE: "+c))}f[this.d].plain=this.c.subarray(b,this.g);f[this.d].compressed=r?
this.input.subarray(a,this.b):this.input.slice(a,this.b);++this.d;b=this.g}this.u=b;f=this.g;this.N?r?(a=new Uint8Array(f),a.set(this.c.subarray(0,f))):a=this.c.slice(0,f):a=r?this.c.subarray(0,f):this.c.slice(0,f);return this.buffer=a};
var x=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],y=r?new Uint16Array(x):x,z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],ea=r?new Uint16Array(z):z,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],B=r?new Uint8Array(A):A,C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],fa=r?new Uint16Array(C):C,I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,
13,13],J=r?new Uint8Array(I):I,K=new (r?Uint8Array:Array)(288),L,N;L=0;for(N=K.length;L<N;++L)K[L]=143>=L?8:255>=L?9:279>=L?7:8;var ba=s(K),O=new (r?Uint8Array:Array)(30),P,Q;P=0;for(Q=O.length;P<Q;++P)O[P]=5;var ca=s(O);function u(a,f){for(var b=a.i,c=a.e,d=a.input,e=a.b,h;c<f;)h=d[e++],h===o&&m(Error("input buffer is broken")),b|=h<<c,c+=8;h=b&(1<<f)-1;a.i=b>>>f;a.e=c-f;a.b=e;return h}
function R(a,f){for(var b=a.i,c=a.e,d=a.input,e=a.b,h=f[0],g=f[1],i;c<g;)i=d[e++],i===o&&m(Error("input buffer is broken")),b|=i<<c,c+=8;d=h[b&(1<<g)-1];h=d>>>16;a.i=b>>h;a.e=c-h;a.b=e;return d}
function da(a){function f(a,b,d){for(var c,e,f=0,f=0;f<a;)switch(c=R(this,b)&65535,c){case 16:for(c=3+u(this,2);c--;)d[f++]=e;break;case 17:for(c=3+u(this,3);c--;)d[f++]=0;e=0;break;case 18:for(c=11+u(this,7);c--;)d[f++]=0;e=0;break;default:e=d[f++]=c}return d}var b=u(a,5)+257,c=u(a,5)+1,d=u(a,4)+4,e=new (r?Uint8Array:Array)(y.length),h;for(h=h=0;h<d;++h)e[y[h]]=u(a,3);d=s(e);e=new (r?Uint8Array:Array)(b);h=new (r?Uint8Array:Array)(c);w(a,s(f.call(a,b,d,e)),s(f.call(a,c,d,h)))}
function w(a,f,b){var c=a.c,d=a.g,e=a.f[a.d];a.K=f;e.litlenHuffmanTable=f[3];e.distHuffmanTable=b[3];var h=c.length,g,i,j,k=e.lzss=[],p=0,l=e.lzssCode=[],n=a.f[a.d].litlenCount=new (r?Uint8Array:Array)(286);if(!r)for(j=0;286>j;++j)n[j]=0;for(e.litlenCodeLength=0;256!==((g=R(a,f))&65535);)if(e.litlenCodeLength+=g>>>16,g&=65535,++n[g],256>g)k[p++]=g,d===h&&(c=v(a),h=c.length),c[d++]=g;else{g-=257;j=ea[g];0<B[g]&&(j+=u(a,B[g]));g=R(a,b)&65535;i=fa[g];0<J[g]&&(i+=u(a,J[g]));l.push(k[p++]=new ga(j));d+
j>=h&&(c=v(a),h=c.length);for(;j--;)c[d]=c[d++-i]}for(;8<=a.e;)a.e-=8,a.b--;a.g=d}function ga(a){this.length=a}function v(a,f){var b;b=a.input.length/a.b+1|0;var c=a.input,d=a.c;f&&("number"===typeof f.z&&(b=f.z),"number"===typeof f.H&&(b+=f.H));2>b?(b=(c.length-a.b)/a.K[2],b=258*(b/2)|0,b=b<d.length?d.length+b:d.length<<1):b*=d.length;r?(b=new Uint8Array(b),b.set(d)):b=d;a.c=b;return a.c};function S(a,f){var b,c,d;this.input=a;this.b=0;if(f&&(f.index&&(this.b=f.index),f.j&&(b=f.j),f.q))this.q=f.q;c=a[this.b++];d=a[this.b++];switch(c&15){case T:this.method=T;break;default:m(Error("unsupported compression method"))}0!==((c<<8)+d)%31&&m(Error("invalid fcheck flag:"+((c<<8)+d)%31));d&32&&m(Error("fdict flag is not supported"));this.p=new t(a,{index:this.b,j:b})}
S.prototype.l=function(){var a=this.input,f;f=this.p.l();if(this.q){var a=a[this.b++]<<24|a[this.b++]<<16|a[this.b++]<<8|a[this.b++],b=f;if("string"===typeof b){var b=b.split(""),c,d;c=0;for(d=b.length;c<d;c++)b[c]=(b[c].charCodeAt(0)&255)>>>0}c=1;d=0;for(var e=b.length,h,g=0;0<e;){h=1024<e?1024:e;e-=h;do c+=b[g++],d+=c;while(--h);c%=65521;d%=65521}a!==(d<<16|c)>>>0&&m(Error("invalid adler-32 checksum"))}return f};S.prototype.L=function(){return this.p.f};q("ZlibStat.Inflate",S);
q("ZlibStat.Inflate.prototype.decompress",S.prototype.l);q("ZlibStat.Inflate.prototype.getBlocks",S.prototype.L);function U(a){this.input=a}function V(a){var f,b;f=0;for(b=ha.length;f<b;++f)if(a[f]!==ha[f])return!1;return!0}
U.prototype.parse=function(a){var f=this.J=[],b,c,d,e,h=0,g=[],i,j,k=this.B=[];V(a)||m(Error("invalid png file"));for(this.a=8;;){d=this.a;b=(a[this.a++]<<24|a[this.a++]<<16|a[this.a++]<<8|a[this.a++])>>>0;i=[];for(e=0;4>e;e++)i.push(String.fromCharCode(a[this.a++]));c=i.join("");switch(c){case "IHDR":this.width=(a[this.a++]<<24|a[this.a++]<<16|a[this.a++]<<8|a[this.a++])>>>0;this.height=(a[this.a++]<<24|a[this.a++]<<16|a[this.a++]<<8|a[this.a++])>>>0;this.t=a[this.a++];this.m=a[this.a++];this.v=
a[this.a++];this.w=a[this.a++];this.A=a[this.a++];break;case "IDAT":g.push(r?a.subarray(this.a,this.a+=b):a.slice(this.a,this.a+=b));h+=b;break;case "PLTE":for(j=e=0;e<b;e+=3)k[j++]=[a[this.a++],a[this.a++],a[this.a++],255];break;case "tRNS":if(this.m===ia){e=0;for(i=b;e<i;++e)k[e][3]=a[this.a++]}break;default:this.a+=b}e=a[this.a++]<<24|a[this.a++]<<16|a[this.a++]<<8|a[this.a++]>>>0;f.push({type:c,size:b,crc32:e,position:d});if("IEND"===c)break}a=new (r?Uint8Array:Array)(h);e=d=0;for(i=g.length;e<
i;++e){b=g[e];j=0;for(h=b.length;j<h;++j)a[d++]=b[j]}this.M=(this.O=new S(a)).l();this.h=this.O.p.f;return f};
var ha=[137,80,78,71,13,10,26,10],ia=3,ja={GRAYSCALE:0,TRUECOLOR:2,INDEXED_COLOR:ia,GRAYSCALE_WITH_ALPHA:4,TRUECOLOR_WITH_ALPHA:6},ka=W({UNKNOWN:-Infinity,NONE:0,SUB:1,UP:2,UPAVERAGE:3,PAETH:4,MIXED:-1}),la=W({UNCOMPRESSED:0,COMPRESSED:1}),ma=W({DEFLATE:0}),na=W(ja),oa=W({BASIC:0}),pa=W({NONE:0,ADAM7:1}),qa=W({PERCEPTUAL:0,RELATIVE:1,SATURATION:2,ABSOLUTE:3}),ra=W({UNKNOWN:0,METRE:1}),X={r:ka,P:la,D:ma,C:na,F:oa,G:pa,Q:qa,R:ra};function Y(a,f){this.key=a;this.value=f}
U.prototype.I=function(a,f,b,c){var d=[],e,h,g;b===o&&(b="resulttable");if("object"===typeof c&&null!==c){e=Object.keys(c);h=0;for(g=e.length;h<g;h++)d.push(new Y(e[h],c[e[h]]))}this.parse(this.input);d.push(new Y("Image Header",Z([new Y("Width",this.width),new Y("Height",this.height),new Y("BitDepth",this.t),new Y("ColourType",X.C[this.m]+" ("+this.m+")"),new Y("CompressionMethod",X.D[this.v]+" ("+this.v+")"),new Y("FilterMethod",X.F[this.w]+" ("+this.w+")"),new Y("InterlaceMethod",X.G[this.A]+" ("+
this.A+")")],f,"ihdr")));d.push(new Y("Chunks",sa(this,f)));0<this.B.length&&d.push(new Y("Palette",ta(this,f)));var i,c=-Infinity,j;e=this.M;g=[];var k,p;if(0===e.length)e=[];else{p=this.t/8*this.width;h=e.length;for(k=j=0;j<h;j+=p)g[k++]=e[j++];e=this.o=g}this.o=e;h=[];g=0;for(j=e.length;g<j;g++)0===g&&(i=e[g]),i!==e[g]&&(c=-1),i=e[g],h[e[g]]=(h[e[g]]>>>0)+1;this.k=c;-1!==c&&0<e.length&&(this.k=e[0]);delete this.n;-1===c&&(this.n=h);d.push(new Y("Filter Mode",X.r[this.k]+(0<=this.k?" ("+this.k+
")":"")));-1===this.k&&(d.push(new Y("Filter Count",ua(this,f))),d.push(new Y("Filters",va(this.o,f))));0<this.h.length&&d.push(new Y("ZLIB Blocks",wa(this,f)));0<this.h.length&&d.push(new Y("ZLIB Huffman Table",xa(this,f)));a.appendChild(Z(d,f,b))};
function ta(a,f){var b="plte",c=a.B,d=[],e,h,g,i;b===o&&(b="plte");e=0;for(h=c.length;e<h;e++)g=c[e],i="rgb("+g.slice(0,3).join(", ")+")",i='<span style="padding-left:1em;background-color:'+i+';">&nbsp;</span>',d.push(new Y(e,[i,"rgba("+g.join(", ")+")"].join(" ")));return Z(d,f,b)}
function sa(a,f){var b="chunks",c=a.J,d,e,h,g=[];b===o&&(b="chunkinfo");e=0;for(h=c.length;e<h;e++)d=c[e],g.push(new Y(d.type,Z([new Y("Size: ",d.size+" Byte"),new Y("Offset: ",d.position),new Y("CRC32: ",ya(d.S))],f,"chunkinfo")));return Z(g,f,b)}
function ua(a,f){var b,c,d,e,h,g,i,j,k;b===o&&(b="filtercount");c=document.createElement("table");c.className=$([f,b]);b=document.createElement("thead");c.appendChild(b);d=document.createElement("tr");b.appendChild(d);for(h=0;3>h;h++)e=document.createElement("th"),d.appendChild(e),e.textContent=["Filter","Count","Ratio"][h];b=document.createElement("tbody");c.appendChild(b);h=0;for(g=a.n.length;h<g;h++)if(d=a.n[h]>>>0,k=(1E4*(d/a.o.length)+0.5>>>0)/100,k=[h+". "+X.r[h],d,k+" %"],0!==d){d=document.createElement("tr");
b.appendChild(d);i=0;for(j=k.length;i<j;i++)e=document.createElement("td"),d.appendChild(e),e.textContent=k[i],0<i&&(e.className=[e.className,$([f,"number"])].join(" "))}return c}
function wa(a,f){var b="blocks";function c(a){var b,c;h=document.createElement("tr");e.appendChild(h);b=0;for(c=a.length;b<c;b++)g=document.createElement("td"),h.appendChild(g),g.textContent=a[b],g.className=[g.className,$([f,"number"])].join(" ")}var d,e,h,g,i,j,k,p,l,n;i="Index Type Plain Compressed Ratio Literal LZSS-Count LZSS-Total LZSS-Avg".split(" ");var za=["Plain","Fixed","Dynamic"],D,E=0,F=0,M=0,G=0,H=0;b===o&&(b="blocks");d=document.createElement("table");d.className=$([f,b]);b=document.createElement("thead");
d.appendChild(b);h=document.createElement("tr");b.appendChild(h);b=0;for(D=i.length;b<D;b++)g=document.createElement("th"),h.appendChild(g),g.textContent=i[b];e=document.createElement("tbody");d.appendChild(e);b=0;for(D=a.h.length;b<D;b++){i=a.h[b];for(j=p=0;255>=j;++j)p+=i.litlenCount[j];n=i.lzssCode.length;for(j=l=0;j<n;++j)l+=i.lzssCode[j].length;k=i.type;j=(1E4*(i.compressed.length/i.plain.length)+0.5|0)/100;E+=i.plain.length;F+=i.compressed.length;M+=p;H+=l;G+=n;c([b,za[k],i.plain.length,i.compressed.length,
j+" %",p,n,l,(100*(l/n)+0.5|0)/100])}c(["Total","-",E,F,(1E4*(F/E)+0.5|0)/100+" %",M,G,H,(100*(H/G)+0.5|0)/100]);return d}function xa(a,f){var b=[],c,d,e;d=0;for(e=a.h.length;d<e;d++)c=a.h[d],0!==c.type&&b.push({key:d,value:Aa(c,f)});return Z(b,f,"huffman")}
function Aa(a,f){var b="huffman-table";function c(a){var b,c;h=document.createElement("tr");e.appendChild(h);b=0;for(c=a.length;b<c;b++)g=document.createElement("td"),h.appendChild(g),g.textContent=a[b],g.className=[g.className,$([f,"number"])].join(" ")}var d,e,h,g,i,j,k=0,p,l=0;i=["Value","Code","Count","Total Bits"];var n;b===o&&(b="huffman-table");d=document.createElement("table");d.className=$([f,b]);b=document.createElement("thead");d.appendChild(b);h=document.createElement("tr");b.appendChild(h);
b=0;for(n=i.length;b<n;b++)g=document.createElement("th"),h.appendChild(g),g.textContent=i[b];e=document.createElement("tbody");d.appendChild(e);b=0;for(n=a.litlenHuffmanTable.length;b<n;b++)i=a.litlenHuffmanTable[b],j=a.litlenCount[i[0]],p=j*i[2],k+=j,l+=p,c([i[0],("0000000000000000"+i[1].toString(2)).split("").reverse().slice(0,i[2]).join(""),j,p]);c(["Total","-",k,l]);return d}
function Z(a,f,b){var c=document.createElement("table"),d=document.createElement("tbody"),e,h,g,i,j,k;b===o&&(b="keyvaluetable");c.className=$([f,b]);c.appendChild(d);g=0;for(i=a.length;g<i;g++)j=a[g].key,k=a[g].value,e=document.createElement("tr"),d.appendChild(e),h=document.createElement("th"),e.appendChild(h),h.className=$([f,b,"key"]),h.textContent=j,h=document.createElement("td"),e.appendChild(h),h.className=$([f,b,"value"]),k instanceof Element?h.appendChild(k):h.innerHTML=k;return c}
function va(a,f){var b,c=document.createElement("table"),d=document.createElement("thead"),e=document.createElement("tbody"),h,g,i;b===o&&(b="hextable");c.className=$([f,b]);c.appendChild(d);c.appendChild(e);h=document.createElement("tr");g=document.createElement("td");g.textContent="Address";h.appendChild(g);for(i=0;16>i;i++)g=document.createElement("td"),g.textContent="+"+"0123456789ABCDEF"[i],h.appendChild(g);d.appendChild(h);for(d=0;d<a.length;d++)0===d%16&&(h=document.createElement("tr"),g=document.createElement("td"),
g.className=$([f,b,"address"]),g.textContent=ya(d),h.appendChild(g),e.appendChild(h)),g=document.createElement("td"),g.className=$([f,b,"hex"]),g.textContent+="0123456789ABCDEF"[a[d]>>>4&15]+"0123456789ABCDEF"[a[d]>>>0&15],h.appendChild(g);return c}function W(a){var f,b,c,d,e={};f=Object.keys(a);b=0;for(c=f.length;b<c;b++)e[a[f[b]]]=f[b];a=Object.keys(e);c=0;for(d=a.length;c<d;c++)f=a[c],b=e[f],e[f]=b[0].toUpperCase().charAt(0)+b.toLowerCase().substr(1);return e}
function $(a){var f=[],b,c;b=0;for(c=a.length;b<c;b++)a[b]!==o&&f.push(a[b]);return f.join("-")}function ya(a){return"0123456689ABCDEF"[a>>>28&15]+"0123456689ABCDEF"[a>>>24&15]+"0123456689ABCDEF"[a>>>20&15]+"0123456689ABCDEF"[a>>>16&15]+"0123456689ABCDEF"[a>>>12&15]+"0123456689ABCDEF"[a>>>8&15]+"0123456689ABCDEF"[a>>>4&15]+"0123456689ABCDEF"[a>>>0&15]}q("PngIdentify",U);q("PngIdentify.isPNG",V);q("PngIdentify.prototype.appendToElement",U.prototype.I);var T=8;}).call(this);
